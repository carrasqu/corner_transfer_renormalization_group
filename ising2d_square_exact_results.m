function [interpolation,mag,beta_c] = ising2d_square_exact_results( beta )

beta_c = log( 1 + sqrt(2) ) / 2;

betas = 0.4:0.001:0.5;

fExact = [-2.198409551929947, -2.1956922717241816, -2.1930020306765696, ...
-2.1903387538053347, -2.1877023706471452, -2.1850928154126956, ...
-2.182510027157877, -2.1799539499723517, -2.177424533187593, ...
-2.1749217316067684, -2.172445505936395, -2.1699958380999944, ...
-2.16757268153589, -2.165175980173783, -2.162805787625715, ...
-2.160462070392448, -2.1581448305437863, -2.1558540785353824, ...
-2.153589834191422, -2.1513521271803744, -2.149140997846443, ...
-2.1469564981743012, -2.144798692876931, -2.1426676639000766, ...
-2.1405634995154745, -2.1384863174972875, -2.1364362398237535, ...
-2.1344134220706876, -2.132418043055671, -2.130450314114034, ...
-2.128510471082337, -2.126598793402337, -2.124715607912684, ...
-2.122861299246151, -2.121036324203958, -2.1192412328574908, ...
-2.117476712168751, -2.1157436083617167, -2.114043042019422, ...
-2.112376568001527, -2.1107437055610934, -2.109158694927365, ...
-2.1076181702285326, -2.106113801351948, -2.104642600050849, ...
-2.10320216414516, -2.101790693225551, -2.1004067362266152, ...
-2.099049058018532, -2.097716589670463, -2.096408385996642, ...
-2.095123595701276, -2.0938614431693416, -2.092621215384071, ...
-2.0914022523737072, -2.0902039432605957, -2.089025704796231, ...
-2.0878669964002543, -2.0867273039372014, -2.0856061509158685, ...
-2.0845030737084507, -2.0834176343101536, -2.0823494134896787, ...
-2.0812980149159093, -2.0802630520423038, -2.0792441584576062, ...
-2.0782409809257665, -2.07725317953955, -2.076280426819278, ...
-2.0753224069052782, -2.0743788148311895, -2.0734493814172392, ...
-2.072533744925572, -2.0716317058683447, -2.0707429716310335, ...
-2.0698672828097484, -2.0690043879061606, -2.068154042774516, ...
-2.067316010267439, -2.066490059908057, -2.065675967585801, ...
-2.0648735152735185, -2.0640824907638886, -2.063302687423316, ...
-2.062533903961719, -2.0617759442168033, -2.06102861695157, ...
-2.0602917356639363, -2.0595651184074764, -2.058848587622391, ...
-2.058141969975893, -2.0574450962112922, -2.056757801005133, ...
-2.056079922831778, -2.055411303834915, -2.054751789705497, ...
-2.0541012295656698, -2.05345947585828, -2.052826384241606, ...
-2.0522018134889572, -2.0515856253928395];

interpolation = interp1( betas , fExact , beta , 'spline' , 12345 );
mag = magnetization( beta , beta_c );
end

function mag = magnetization( beta ,beta_c )

mag = arrayfun( @(x) get_mag(x,beta_c) , beta );

end

function mag = get_mag( beta , beta_c )

mag = 0;

if beta > beta_c
    mag = ( 1 - ( 1 / sinh(2*beta) )^4 ) ^ (1/8);
end

end
